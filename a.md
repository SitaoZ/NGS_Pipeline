以下是根据需求设计的Excel公式解决方案：

### 步骤说明
1. **排除节假日**：判断某天是否为节假日（所有员工休假）。
2. **动态统计值班次数**：使用辅助区域记录每位员工的值班次数。
3. **选择值班人**：优先选择当天出勤的员工中值班次数最少且序号最小的员工。

### 公式实现
假设：
- 员工数据在 `Sheet1` 的 `A2:B9`（序号和姓名）。
- 每日考勤数据从 `C2:AG9`。
- 值班人结果从 `C10:AG10`。

**步骤1：判断是否为工作日**  
在 `C10` 输入以下公式（向右拖动填充至 `AG10`）：
```excel
=IF(COUNTIF(C2:C9,"出勤")=0, "节假日", "")
```

**步骤2：动态统计值班次数并选择值班人**  
修改 `C10` 的公式为以下数组公式（按 `Ctrl+Shift+Enter` 输入）：
```excel
=IF(COUNTIF(C2:C9,"出勤")=0, "节假日",
  INDEX($B$2:$B$9,
    MATCH(
      MIN(
        IF(
          C2:C9="出勤",
          $A$2:$A$9 + COUNTIF($B$10:B$10, $B$2:$B$9)*1000,
          1E+100
        )
      ),
      $A$2:$A$9 + COUNTIF($B$10:B$10, $B$2:$B$9)*1000,
      0
    )
  )
)
```

### 公式解释
1. **COUNTIF(C2:C9,"出勤")=0**：判断是否为节假日。
2. **COUNTIF($B$10:B$10, $B$2:$B$9)**：统计从 `B10` 到当前列前一列的值班次数。
3. **$A$2:$A$9 + ...*1000**：将序号与值班次数组合，确保次数少的优先，次数相同则序号小的优先。
4. **MIN(IF(...))**：找到符合条件的员工的最小值。
5. **INDEX 和 MATCH**：返回对应的员工姓名。

### 使用说明
1. **输入公式**：在 `C10` 输入上述数组公式，按 `Ctrl+Shift+Enter` 确认。
2. **拖动填充**：将 `C10` 的公式向右拖动至 `AG10`。
3. **结果展示**：每个工作日会自动分配值班人，节假日显示“节假日”。

### 示例效果
- **第1天（C列）**：选择序号最小的出勤员工（蒋宇）。
- **第2天（D列）**：若蒋宇已值班1次，则选择下一个次数最少且序号小的出勤员工（钱新，序号2）。
- **后续日期**：动态调整，确保值班次数均衡。

此公式通过动态引用之前的排班记录，确保值班次数接近，同时优先考虑序号较小的员工。
