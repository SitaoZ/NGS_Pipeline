质谱数据格式主要分为 **厂商专有原始格式** 和 **开放通用格式** 两大类，它们在数据完整性、兼容性、处理效率和应用场景上有显著差异。以下是主流格式的分类与特点详解：

---

### **一、厂商专有原始格式（Proprietary Raw Formats）**
> **特点**：仪器直接生成，包含最完整的原始数据（Profile模式、仪器参数、日志等），需厂商软件或授权库读取。

| 格式                  | 厂商         | 扩展名       | 特点与局限                                                                 |
|-----------------------|--------------|--------------|----------------------------------------------------------------------------|
| **Thermo RAW**        | Thermo Fisher | `.raw`       | - **高分辨率仪器标准格式**（Orbitrap/Q-Exactive等）<br>- 包含全扫描原始数据、色谱图、仪器参数<br>- 需**Xcalibur**或**RawFileReader**库解析 |
| **Sciex WIFF**        | SCIEX        | `.wiff`      | - TripleTOF等仪器专用<br>- 支持成像数据存储<br>- 需**Analyst TF**或开放工具包读取 |
| **Waters RAW**        | Waters       | `.raw`       | - 四极杆/飞行时间仪器通用<br>- 需**MassLynx**软件处理<br>- 目录结构包含多个子文件 |
| **Bruker .d**         | Bruker       | `.d` (目录)  | - FTMS/qTOF等格式<br>- 以**文件夹形式存储**（含`analysis.yep/fid`等文件）<br>- 需**Compass DataAnalysis** |
| **Agilent .d**        | Agilent      | `.d` (目录)  | - Q-TOF/QQQ等仪器使用<br>- 文件夹含`AcqData`等子文件<br>- 需**MassHunter**打开 |

**核心优势**：  
✅ 保留100%原始信息（包括Profile数据、校准参数、电压日志等）  
✅ 支持仪器控制软件深度重处理（如重新积分、峰检测）  

**主要局限**：  
❌ **封闭性**：需厂商软件或付费库解析（如Thermo的RawFileReader SDK）  
❌ **跨平台兼容差**：开源工具（如Python/R）直接读取困难  

---

### **二、开放通用格式（Open Community Formats）**
> **特点**：标准化、跨平台兼容，适合数据共享与开源分析，但可能损失部分元数据。

#### **1. XML-Based 格式**
| 格式          | 特点                                                                 | 应用场景                     |
|---------------|----------------------------------------------------------------------|------------------------------|
| **mzML**      | - **HUPO-PSI标准**（最新主流）<br>- 支持**Profile/Centroid**模式<br>- 完整元数据（CV参数控制词汇）<br>- 支持**索引**（快速访问）和**压缩**（zlib） | 组学研究、公共数据库（PRIDE）|
| **mzXML**     | - 早期通用格式（逐步被mzML替代）<br>- 结构较简单<br>- 元数据支持有限                   | 旧版软件兼容、历史数据       |
| **mzData**    | - 已弃用的PSI标准（不推荐新数据使用）                                           | 旧数据集归档                 |

#### **2. 文本/轻量级格式**
| 格式          | 特点                                                                 | 应用场景                     |
|---------------|----------------------------------------------------------------------|------------------------------|
| **.mgf**      | - **质谱图文本格式**<br>- 存储**碎片离子**（MS/MS谱图）<br>- 每张谱图头包含前体离子信息（PEPMASS） | 数据库搜索（Mascot/X!Tandem）|
| **.msp**      | - **NIST质谱库标准**<br>- 每张谱图含化合物名称、离子列表<br>- 支持保留时间/碰撞能量等元数据 | 构建自定义质谱库、代谢物鉴定 |
| **.txt/.csv** | - 自定义表格格式（无统一标准）<br>- 通常包含两列：`m/z` 和 `Intensity`（Centroid模式） | 快速数据交换、简单可视化     |

#### **3. 高性能二进制格式**
| 格式          | 特点                                                                 | 应用场景                     |
|---------------|----------------------------------------------------------------------|------------------------------|
| **mz5**       | - mzML的**二进制优化版**<br>- **读写速度快50%**<br>- 文件体积更小<br>- 支持HDF5存储引擎 | 大规模组学数据分析           |
| **imzML**     | - **质谱成像专用**<br>- 分两部分：<br>  - `.ibd`（二进制离子数据）<br>  - `.imzML`（XML描述坐标与m/z） | MALDI/SIMS成像数据分析       |

---

### **三、关键特性对比总结**
| **特性**          | 厂商格式（.raw/.wiff） | mzML/mzXML       | 文本格式（.mgf/.msp） | 高性能格式（mz5/imzML） |
|-------------------|------------------------|------------------|------------------------|-------------------------|
| **数据完整性**    | ★★★★★ (全原始数据)     | ★★★★☆ (可能丢失部分日志) | ★★☆☆☆ (仅峰列表)       | ★★★★☆                   |
| **兼容性**        | ★☆☆☆☆ (需厂商软件)      | ★★★★★ (开源工具友好)    | ★★★★★ (通用)           | ★★★★☆ (需专用库)        |
| **读取速度**      | ★★☆☆☆ (较慢)           | ★★★☆☆ (中等)      | ★★★★★ (极快)           | ★★★★★ (优化二进制)      |
| **文件大小**      | 极大 (GB级)            | 中等 (可压缩50%)  | 极小 (MB级)            | 较小 (比mzML减30%)      |
| **支持数据类型**  | Profile+Centroid+色谱  | Profile/Centroid | Centroid (MS/MS为主)   | 支持所有质谱数据        |
| **适用场景**      | 原始数据处理/重分析     | 数据共享/发表     | 谱库搜索/快速查看       | 大规模计算/成像分析     |

---

### **四、格式转换工具推荐**
1. **ProteoWizard**：  
   - 开源工具，支持**Thermo/Sciex/Waters → mzML/mzXML**  
   - 命令：`msconvert example.raw --filter "peakPicking true 1-" -o mzML/`  
2. **OpenMS**：  
   - 处理mzML/mzData，支持**高级算法集成**（如特征检测）  
3. **厂商软件**：  
   - Thermo Xcalibur → File > Export  
   - Waters MassLynx → File > Save As (mzML/mzXML)  

---

### **五、选型建议**
- **保留原始数据**：始终存档厂商专有格式（`.raw/.d/.wiff`）  
- **共享与发表**：使用 **mzML**（提供CV参数确保可复现性）  
- **碎片离子分析**：导出 **.mgf** 提交至数据库搜索工具  
- **构建质谱库**：采用 **.msp** 格式兼容NIST/GNPS平台  
- **大数据处理**：转换为 **mz5** 加速计算流程  
- **成像数据**：必须使用 **imzML**  

> 💡 **期刊要求**：多数期刊（如Nature Methods）要求质谱原始数据上传至公共库（PRIDE/MassIVE）时提供 **mzML + 实验元数据**。
