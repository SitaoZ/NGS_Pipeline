# ImmuneRepertoire 免疫组库

## 细胞免疫和体液免疫

[**细胞免疫**](https://zh.wikipedia.org/wiki/%E7%BB%86%E8%83%9E%E4%BB%8B%E5%AF%BC%E5%85%8D%E7%96%AB)和[**体液免疫**](https://zh.wikipedia.org/wiki/%E4%BD%93%E6%B6%B2%E5%85%8D%E7%96%AB)，作为人体免疫系统的两大核心组成部分，各自承担着不同的功能，但同时又紧密相连，共同维护着人体的健康。 
`细胞免疫`主要通过`T淋巴细胞`来识别和清除被感染的细胞或癌细胞，而`体液免疫`则通过`B淋巴细胞`产生抗体来中和病毒或细菌。
尽管它们在机制和功能上有所区别，但两者在免疫反应中相互协作，共同应对外来的病原体。

- 细胞来源不同  
体液免疫：B细胞  
细胞免疫：T细胞

- 作用对象不同  
体液免疫： 抗原   
细胞免疫：被抗原入侵的细胞、自身的异常细胞和异体组织器官

- 作用方式不同  
体液免疫：浆细胞（效应B细胞）产生的抗体与相应病原体的抗原特异性结合，并使之发生进一步的变化（如形成沉淀）而被吞噬细胞吞噬，从而抑制病原体的繁殖或对人体细胞的黏附。  
细胞免疫：效应T细胞与靶细胞密切接触，并释放穿孔素使靶细胞裂解。




## TCR、BCR
- T细胞和B细胞表面存在受体分子分别称为`TCR(T cell receptor)`和`BCR(B cell receptor)`

TCR和BCR库通过特异性克隆增值或者提高抗体亲和力，以产生适应性免疫应答来抵抗自身和外部抗原感染，在保持个体健康方面发挥着重要作用。 
在T和B淋巴细胞的发育过程中，TCR或BCR由V、D、J基因片段（位于染色体上的大量V或D或J基因）重排形成;正常情况下，V/D/J基因随机组合，
并在V-D或D-J连接处随机插入或删除一些核苷酸，结果，使每个个体产生大量的TCR和BCR。 理论上估计，对于人类来说，将会有超过10<sup>18</sup>种独
特的TCR和2×10<sup>12</sup>种独特的BCR。 因此，巨大的T和B细胞的多样性构成了个体的免疫系统，在一定程度上反映其免疫能力。


## TCR、BCR结构
BCR 是在 B 细胞膜上表达的免疫球蛋白 (Ig) 的膜结合形式，由两条相同的重链 (IgH：µ，α，γ，δ，ε) 和两条相同的轻链(IgL：κ，λ) 通过二硫键连接而成。BCR 重链分为可变区（V 区）、恒定区（C 区）、跨膜区及胞质区；轻链则只有 V 区和 C 区。
V 区由 3 个互补决定区（CDR1、CDR2 和 CDR3）组成，CDR 的氨基酸/基因组成和排列顺序呈现高度多样性，在同一个体内，这种多样性可达 10<sup>9</sup>~10<sup>12</sup>，构成容量巨大的 BCR 库。正是这种多样性的存在，正常机体几乎能够对入侵的所有异物产生免疫应答。

免疫球蛋白有IgA、IgG、IgM、IgD、IgE五种，各自可以搭配κ或λ两种轻链。IG的恒定区决定了它的免疫原性，即重链的恒定区决定了它是5种免疫球蛋白中的哪一种，轻链的恒定区决定了搭配重链的是两种轻链中的哪一种；BCR的可变区多样性则决定了抗原识别的多样性和特异性。

BCR和抗体是什么关系呢？免疫球蛋白包括膜型和分泌型，膜型IG即为BCR，表达在B细胞表面，参与抗原识别和B细胞激活；当B细胞被抗原激活，则会分泌抗体与抗原特异性结合，所以抗体是B细胞激活后分泌的可溶性蛋白，主要存在于血清、组织液和外分泌液中。二者在结构和功能上既有联系也有区别。


TCR 是一种异二聚体，由 T 细胞膜表面两个二硫键连接的跨膜蛋白组成：
一个 α 链和一个 β 链，或者一个 γ 链和一个 δ 链。
α 和 β 链的 V 区包含 3 个互补决定区 CDRs 和 4 个框架区 FRs，其中 CDR 区是细胞的高变区，
与抗原特异性结合，CDR1、CDR2 由 V 基因编码，
而 CDR3 由 VDJ 三个基因编码，在免疫细胞成熟过程中 VDJ 基因发生重排从而形成了 TCR 多变性。而且多样性可达 10<sup>15</sup>~10<sup>18</sup>。


BCR、TCR 存在一块区域称作互补决定区（Complementary Determining Region，CDR），
在抗原识别中起关键作用；CDR 由 CDR1，CDR2，CDR3 组成，CDR1 和 CDR2 都是由 V 基因编码，
而 CDR3 则由 V、D、J 三个基因编码形成，CDR3 多样性程度最高。
因此，常通过对 CDR3 区基因序列的研究，对疾病诊断、监测 MRD、免疫评估等具有重要意义。

## BCR的发育机制
和TCR一样，V（D）J基因重组是产生BCR多样性的关键机制，重组过程包括V（D）J基因片段的随机选择和碱基的插入和删除替换等。与TCR不同的是，初始B细胞会经历类别转换重组(CSR)和体细胞超突变(SHM)，以增强免疫球蛋白识别和结合外源抗原的能力以及抗体的效应能力。

- VDJ基因重组
B细胞的发育经历几个阶段：干细胞-淋巴样祖细胞-祖B细胞（pro-B）-前B细胞（pre-B）-未成熟B细胞-成熟B细胞，在B细胞发育成熟的过程中发生V（D）J基因重排形成BCR。在proB阶段首先发生H链的D-J基因重排， 然后V-DJ基因重排，重链基因重排后preB阶段进行轻链VJ重排，一般k链基因先重排，如果k链重排失败，就转为λ链基因的重排，然后轻链和重链组装成完整的BCR，表达在未成熟B细胞的表面，表达mIgM。成熟的B细胞可同时表达mIgM和mIgD。（图2-3）

VDJ基因重排具有随机性。从染色体基因组中随机各选取一个V、（D）、J基因片段进行重排，V和D的之间、D和J的之间还会有核酸的随机插入和删除替换，因此形成了BCR库的巨大多样性。（图4）

- 类别转换重组
B细胞在骨髓中产生后，其表面展示两种类型的抗体——IgM和IgD，这是原代B细胞的BCR。当B细胞离开骨髓时，因为还没有被激活，它不分泌抗体，一旦B细胞被同源抗原激活，B细胞就会产生默认的抗体类型——IgM，同时B细胞也可能会将其产生的抗体类型由IgM转变为IgG、IgE、IgA中的任何一种。抗体的类型是由重链的恒定区（Fc片段）决定的，恒定区可以与在不同细胞表面表达的相应受体互作，介导抗体效应功能。

- 体细胞超突变
通常在人体细胞中，DNA整体突变率极低，然而免疫球蛋白V区的基因会产生相当高的突变率（主要是点突变，大约每一千个碱基中就有一个发生突变），这种高突变现象叫做“体细胞超突变（SHM）”，通常在类型转换后发生。

SHM改变了抗体的抗原结合区，突变后，具有更高亲和力BCR的B细胞更容易受到刺激和增殖。因此，SHM的结果是能产生更多对同源抗原有高亲和力BCR的B细胞，这个过程称之为亲和力成熟。

因此，B细胞通过类型转换可改变抗体的恒定区，通过体细胞高频突变可改变抗体的抗原结合区，通过亲和力成熟选择出了高亲和力的抗体，修饰的结果都是产生能更好对付入侵者的B细胞。

## BCR测序应用方向
BCR测序是通过高通量测序技术检测靶向扩增后的BCR重链和轻链，全面解析BCR基因重排碱基序列，以及各序列的丰度，从而揭示B细胞介导的体液免疫应答机制以及免疫球蛋白的多样性变化。

主要应用于血液肿瘤微小残留病（MRD）检测、自身免疫性疾病、疫苗/抗体药物研发、肿瘤或传染病免疫反应监测等领域。



## Running Cell Ranger multi with 5' Immune Profiling Data

###  数据下载
we will work with the human B cells dataset from a Healthy Donor (1k cells)

```bash
mkdir dataset-multi-practice
cd dataset-multi-practice

curl -LO https://cf.10xgenomics.com/samples/cell-vdj/6.0.0/sc5p_v2_hs_B_1k_multi_5gex_b_Multiplex/sc5p_v2_hs_B_1k_multi_5gex_b_Multiplex_fastqs.tar
# wget https://cf.10xgenomics.com/samples/cell-vdj/6.0.0/sc5p_v2_hs_B_1k_multi_5gex_b_Multiplex/sc5p_v2_hs_B_1k_multi_5gex_b_Multiplex_fastqs.tar

tar -xf sc5p_v2_hs_B_1k_multi_5gex_b_Multiplex_fastqs.tar


# Download the reference transcriptome and V(D)J reference
# curl -O https://cf.10xgenomics.com/supp/cell-exp/refdata-gex-GRCh38-2020-A.tar.gz
wget https://cf.10xgenomics.com/supp/cell-exp/refdata-gex-GRCh38-2020-A.tar.gz
tar -xf refdata-gex-GRCh38-2020-A.tar.g

# Download the pre-build VDJ reference 
curl -O https://cf.10xgenomics.com/supp/cell-vdj/refdata-cellranger-vdj-GRCh38-alts-ensembl-5.0.0.tar.gz
tar -xf refdata-cellranger-vdj-GRCh38-alts-ensembl-5.0.0.tar.gz

```

